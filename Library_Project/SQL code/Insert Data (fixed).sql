USE HTThuVien
GO

--Insert dữ liệu

--NHACUNGCAP(1)
insert into NHACUNGCAP values (1, 'Nha xuat ban BCD')
GO

--SACH(2)
insert into SACH  values (1,N'Vui Vẻ Không Quạu Nha', N'Nhiều tác giả',53000, 100, 1, N'Văn học', N'Vui vẻ không quạu nha - xin được gửi đến những bạn trẻ đang dễ giận dữ, cau có ngoài thế giới kia, những ai đang buồn phiền về rắc rối nào đó, “trái tim” nhỏ bé này còn phải dành cho niềm vui, đừng để bực bội, dỗi hờn từ những điều không đáng chiếm hết chỗ. Và hãy hét to với Thế giới rằng “Mình là một người tràn đầy năng lượng,” luôn sẵn sàng để hạnh phúc hơn.','020##a005.71262',N'Tản văn');
insert into SACH  values (2,N'Những Gì Đã Qua Đừng Nghĩ Lại Quá Nhiều', N'Minh Mẫn',54000, 100, 1, N'Văn học', N'Cuốn sách là sự kết hợp tuyệt vời giữa hai nhà văn trẻ nổi tiếng: Minh Mẫn và Du Phong hứa hẹn sẽ đem đến cho những tâm hồn đang tổn thương sự vui vẻ và nhẹ nhõm trước những nỗi đau quá khứ. Những ai từng mất rất nhiều thời gian để quên đi một mối tình khắc cốt ghi tâm. Ai còn mang nặng nỗi đau quá khứ, những người còn chưa đành lòng quên đi một tình cảm đau khổ hay những người cứ mãi day dứt, băn khoăn về một việc đã qua,… Sau tất cả, điều ta nhận ra là: Thời gian rồi sẽ chữa lành mọi thứ, dù bạn có muốn hay không. ','08204222nded.',N'Sách phát triển bản thân')
insert into SACH  values (3,N'Giáo Trình C++ Và Lập Trình Hướng Đối Tượng', N'Phạm Văn Ất',114000, 100, 1, N'Sách giáo khoa', N'“Giáo trình C++ & lập trình hướng đối tượng” trình bày một cách hệ thống các khái niệm của lập trình hướng đối tượng được cài đặt trong C++ như lớp, đối tượng, sự thừa kế, tính tương ứng bội và các khả năng mới trong xây dựng, sử dụng hàm như đối tham chiếu, đối mặc định, hàm trùng tên, hàm toán tử.Ngoài ra, cuốn sách còn đề cập đến một số vấn đề còn ít được biết đến như cách xây dựng hàm với số đối bất định trong C cũng sẽ được giới thiệu .','020c78000',N'Sách chuyên ngành')
insert into SACH  values (4,N'Thiên Tài Bên Trái, Kẻ Điên Bên Phải', N'Cao Minh',86000, 100, 1, N'Tham khảo', N'Thiên tài bên trái, kẻ điên bên phải là cuốn sách dành cho những người điên rồ, những kẻ gây rối, những người chống đối, những mảnh ghép hình tròn trong những ô vuông không vừa vặn… những người nhìn mọi thứ khác biệt, không quan tâm đến quy tắc. Bạn có thể đồng ý, có thể phản đối, có thể vinh danh hay lăng mạ họ, nhưng điều duy nhất bạn không thể làm là phủ nhận sự tồn tại của họ. Đó là những người luôn tạo ra sự thay đổi trong khi hầu hết con người chỉ sống rập khuôn như một cái máy.','020##a9780199652709',N'Kỹ năng sống')
insert into SACH  values (5,N'Oxford Advanced Learners Dictionary 8th Edition (With Vietnamese Translation)', N'Oxford University',979000, 100, 1, N'Tham khảo', N'Oxford Advanced Learners Dictionary (viết tắt: OALD) bao gồm CD-ROM - từ điển bán chạy nhất thế giới - vừa ra mắt ấn bản Anh - Việt.','020##a9780194505321',N'Từ điển')
insert into SACH  values (6,N'Giáo Trình Lập Trình Cơ Sở', N'Nhiều tác giả',67000, 100, 1, N'Sách giáo khoa', N'Sau khi nghiên cứu cuốn giáo trình này, bạn đọc có thể nắm vững các kiến thức cơ bản về cách xây dựng thuật toán và cài đặt mã lệnh. Cuối mỗi chương là hệ thống bài tập từ dễ đến khó, đối với các bài tập khó đều có gợi ý về cách giải','020##a9786048000602',N'Ngôn ngữ lập trình máy tính')
insert into SACH  values (7,N'Sống Có Kế Hoạch', N'Paula Rizzo',110000, 100, 1, N'Văn học', N'Sống Có Kế Hoạch" giúp bạn thực hiện cách sử dụng danh sách để có năng suất cao hơn, thành công cao và ít căng thẳng hơn trong cuộc sống bộn bề. Sách đã được dịch sang 12 ngôn ngữ và đã được đăng trên nhiều phương tiện truyền thông bao gồm Fox News , Fox Business, Prevention, Business Insider, Entrepreneur, Brides và được trang O’s chọn đăng trong danh sách  “Self Help Books That Actually Help."','300##a248p',N'Kỹ năng sống')
insert into SACH  values (8,N'Chết Có Kế Hoạch', N'Laura Pritchett',190000, 100, 1, N'Văn học', N'Chúng ta, ai rồi cũng sẽ phải đối diện với cái chết. Rồi ta sẽ là giọt mưa, chiếc lá, con ong, sợi khói. Ta sẽ hiện diện cho nơi này một chút buồn, nơi nọ một chút vui. Nghe thật “xúi quẩy” nhưng với Chết Có Kế Hoạch, tác giả mở toang sự thật về việc thực hành tập chết, lập một tờ di chúc để nói về những mong ước sau cùng, những điệu nhạc, lời cầu nguyện được nghe khi lâm chung sẽ phần nào giúp chúng ta ra đi thanh thản hơn.','08204223rd	ed.',N'Sách phát triển bản thân')
insert into SACH  values (9,N'Giáo Trình Cơ Học Chất Lỏng', N'ThS Trần Thanh Thảo',78000, 100, 1, N'Sách giáo khoa', N'Môn khoa học cơ bản, nghiên cứu các quy luật chuyển động, cân bằng của lưu chất và các quá trình tương tác lực của nó lên các vật thể khác. Các vấn đề nghiên cứu trong phạm vi môn học rất đa dạng có nhiều ứng dụng trong hoạt động của người kỹ sư. ','020c32000',N'Fluid mechanics')
insert into SACH  values (10,N'Call Me By Your Name', N'André Aciman',316000, 100, 1, N'Văn học', N'Gọi em bằng tên anh là câu chuyện tình yêu bất ngờ và mạnh mẽ nảy nở giữa thiếu niên 17 tuổi tên Elio với Oliver, một học giả Mỹ là khách trọ mùa hè ở căn biệt thự của ba mẹ Elio tại vùng duyên hải Riviera nước Ý thập niên 1980. Trong những tuần mùa hè sôi động ấy, dòng chảy cuồn cuộn ám ảnh và đam mê bị kìm nén càng làm mãnh liệt thêm tình yêu giữa hai chàng trai trẻ. Cuốn tiểu thuyết đầu tay của André Aciman là một khúc bi ca chân thành và cảm động dành cho tình yêu con người. Một cuốn sách không thể nào quên.','020##a9781786495259',N'Thiếu niên')
GO

--NHANVIEN(3)
INSERT INTO NHANVIEN VALUES (1,N'1',N'Võ Văn Trung',N'Bộ phận bổ sung'),(2,N'2',N'Nguyễn Ngọc Quí',N'Bộ phận bổ sung'),
(3,N'3',N'Dương Thị Ý',N'Bộ phận phân loại'),(4,N'4',N'Nguyễn Bảo Ngọc',N'Bộ phận phân loại'),
(5,N'5',N'Nguyễn Thị Ngọc Hân',N'Bộ phận biên mục'),(6,N'6',N'Trần Quốc Bảo',N'Bộ phận biên mục'),
(7,N'7',N'Nguyễn Phương Nguyên',N'Bộ phận chủ đề'),(8,N'8',N'Đặng Thị Vân Khánh',N'Bộ phận chủ đề'),
(9,N'9',N'Nguyễn Thị Giang',N'Bộ phận lưu hành'),(10,N'10',N'Trương Bảo Nam',N'Bộ phận lưu hành'),
(11,N'11',N'Trương Huỳnh Kim Ngân',N'Chuyên viên cao học'),(12,N'12',N'Vũ Đức Toàn',N'Chuyên viên cao học'),
(13,N'13',N'Bùi Thị Xuân Quỳnh',N'Nhân viên văn phòng'),(14,N'14',N'Trần Hiếu Nghĩa',N'Nhân viên văn phòng'),
(15,N'15',N'Trầm Vương Huyền Trân',N'Cán bộ quản lý thẻ'),(16,N'16',N'Trần Đặng Đạt',N'Cán bộ quản lý thẻ'),
(17,N'17',N'Dương Khánh Vi',N'Thủ thư')
GO

--THANHLY
INSERT INTO THANHLY VALUES (1,N'Chưa xác nhận')
GO

--DSTHANHLY
INSERT INTO DSTHANHLY VALUES (1,4,N'Không được mượn trong thời gian lâu','2020-08-07',N'Có 2 bản sao lưu'),
(1,3,N'Không phù hợp với thị hiếu độc giả','2020-08-07',N'Có 7 bản sao lưu')
GO

--THETHUVIEN
CREATE PROC sp_InTTV @N Int
AS
	DECLARE @I INT=1
	WHILE(@I<=@N)
	BEGIN
		IF(@I<((2*@N)/3))
			INSERT INTO THETHUVIEN VALUES('SV'+CAST(@I AS nvarchar),N'Nguyễn A'+CAST(@I AS nvarchar),'TP HCM','0912748237',N'Hợp lệ')
		ELSE
			INSERT INTO THETHUVIEN VALUES('CB'+CAST(@I AS nvarchar),N'Trần T'+CAST(@I AS nvarchar),'TP HCM','0976432962',N'Hợp lệ')
		SET @I=@I+1
	END
GO
EXEC sp_InTTV 100
GO

--DSDKTHE
INSERT INTO DSDKTHE VALUES ('SV400',N'Cá nhân','sv400@gmail.com',NULL,0,0),('CB180',N'Cá nhân','cb180@gmail.com',NULL,1,0)
GO

--SINHVIEN
CREATE PROC sp_InSV @N Int
AS
	DECLARE @I INT
	SET @I=(SELECT MAX(MASV) FROM SINHVIEN)
	IF(@I IS NULL)
		SET @I=1
	ELSE
		SET @I=(SELECT MAX(MASV) FROM SINHVIEN)+1
	WHILE(@I<=@N)
	BEGIN
		INSERT INTO SINHVIEN VALUES('SV'+CAST(@I AS nvarchar),N'Nguyễn A'+CAST(@I AS nvarchar),N'Chính qui','US')
		SET @I=@I+1
	END
GO
EXEC sp_InSV 500
GO

CREATE PROC sp_UpHeSV @N INT
AS
	DECLARE @I INT=1
	WHILE(@I<@N)
	BEGIN
		IF(@I<(1*@N)/3)
		BEGIN
			IF(@I%5=0)
				UPDATE SINHVIEN SET HE=N'Chất lượng cao' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
			ELSE IF(@I%4=0)
				UPDATE SINHVIEN SET HE=N'Tiên tiến' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
			ELSE
				UPDATE SINHVIEN SET HE=N'Việt-Pháp' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
		END
		SET @I=@I+1
	END
GO
EXEC sp_UpHeSV 500
GO

CREATE PROC sp_UpTruongSV @N INT
AS
	DECLARE @I INT=1
	WHILE (@I<=@N)
	BEGIN
		IF(@I%3=0)
			UPDATE SINHVIEN SET TRUONG ='UEL' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
		ELSE IF(@I%7=0)
			UPDATE SINHVIEN SET TRUONG ='UT' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
		ELSE IF(@I%4=0)
			UPDATE SINHVIEN SET TRUONG ='USSH' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
		ELSE IF(@I%6=0)
			UPDATE SINHVIEN SET TRUONG ='UIT' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
		ELSE
			UPDATE SINHVIEN SET TRUONG ='US' WHERE MASV='SV'+CAST(@I AS NVARCHAR)
		SET @I=@I+1;
	END
GO
EXEC sp_UpTruongSV 500
GO
SELECT*FROM SINHVIEN

--CANBO
CREATE PROC sp_InCB @N Int
AS
	DECLARE @I INT
	SET @I=(SELECT MAX(MACB) FROM CANBO)
	IF(@I IS NULL)
		SET @I=1
	ELSE
		SET @I=(SELECT MAX(MACB) FROM CANBO)+1
	WHILE(@I<=@N)
	BEGIN
		INSERT INTO CANBO VALUES('CB'+CAST(@I AS nvarchar),N'Trần T'+CAST(@I AS nvarchar),N'Chính qui','US')
		SET @I=@I+1
	END
GO
EXEC sp_InCB 200
GO

CREATE PROC sp_UpHeCB @N INT
AS
	DECLARE @I INT=1
	WHILE(@I<@N)
	BEGIN
		IF(@I>(2*@N)/3)
		BEGIN
			IF(@I%5=0)
				UPDATE CANBO SET LOAIDAOTAO=N'Chất lượng cao' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
			ELSE IF(@I%4=0)
				UPDATE CANBO SET LOAIDAOTAO=N'Tiên tiến' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
			ELSE
				UPDATE CANBO SET LOAIDAOTAO=N'Việt-Pháp' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
		END
		SET @I=@I+1
	END
GO
EXEC sp_UpHeCB 200
GO

CREATE PROC sp_UpTruongCB @N INT
AS
	DECLARE @I INT=1
	WHILE (@I<=@N)
	BEGIN
		IF(@I%2=0)
		BEGIN
			IF(@I%6=0)
				UPDATE CANBO SET TRUONG ='UEL' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
			IF(@I%4=0)
				UPDATE CANBO SET TRUONG ='UT' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
			IF(@I%5=0)
				UPDATE CANBO SET TRUONG ='UIT' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
			ELSE
				UPDATE CANBO SET TRUONG ='USSH' WHERE MACB='CB'+CAST(@I AS NVARCHAR)
		END
		SET @I=@I+1;
	END;
GO
EXEC sp_UpTruongCB 200
GO
SELECT*FROM CANBO 
UPDATE CANBO SET TRUONG='UEL' WHERE MACB='CB18'
UPDATE CANBO SET TRUONG='UEL' WHERE MACB='CB98'

--LSGIAODICH
INSERT INTO LSGIAODICH VALUES (1,'SV1',7,'2018-02-02','2018-02-16','2018-02-10',N'Đã trả'),
(2,'SV1',8,'2018-12-09','2018-12-15','2018-12-14',N'Đã trả'),
(3,'CB90',10,'2019-01-02','2018-01-16','2018-02-10',N'Quá hạn'),
(4,'SV7',9,'2019-06-12','2019-06-26','2019-06-24',N'Mất sách'),
(5,'CB83',5,'2019-11-08','2019-11-22','2019-11-10',N'Hư hỏng'),
(6,'CB90',8,'2020-04-25','2020-05-10','2020-05-29',N'Quá hạn')
GO

--PHAT
INSERT INTO PHAT VALUES (1,3,N'Call Me By Your Name','2018-02-10',N'Trần T5',27000,17,N'Quá hạn'),
(2,4,N'Giáo Trình Cơ Học Chất Lỏng','2019-06-24',N'Nguyễn A7',128000,17,N'Mất sách'),
(3,5,N'Oxford Advanced Learners Dictionary 8th Edition (With Vietnamese Translation)','2019-11-10',N'Trần T3',1029000,17,N'Hư hỏng'),
(4,6,N'Chết Có Kế Hoạch','2020-05-29',N'Trần T1',19000,17,N'Quá hạn')
GO

SELECT*FROM SACH
SELECT*FROM NHANVIEN
SELECT*FROM NHACUNGCAP
SELECT*FROM THANHLY
SELECT*FROM DSTHANHLY
SELECT*FROM DSDKTHE
SELECT*FROM THETHUVIEN
SELECT*FROM SINHVIEN
SELECT*FROM CANBO
SELECT*FROM LSGIAODICH
SELECT*FROM PHAT
